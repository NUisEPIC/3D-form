@import '_vars'
@import '_base'
@import 'formula-inputs'

// formula

.formula
  display block
  margin 0 auto
  width 85%
  position relative
  max-width 700px
  transition all ease 1s
  perspective 300px
  perspective-origin center center
  max-height 100%

  .header
    background-image url(../images/epic-logo.png)
    background-size contain
    background-repeat no-repeat
    width 300px
    height 300px
    display block
    margin 0 auto
    z-index 2
    position relative

  .primary-window
    border-radius 4px
    box-shadow 0 0 15px rgba(0,0,0,0.2)
    position relative

    max-height 100%
    background radial-gradient(circle, #f2f2f2 0%, #ebebeb 100%)
    transition transform ease 0.5s,
               left ease 0.5s,
               max-height ease 0.5s

    transform-style preserve-3d

    overflow hidden
    top -150px
    left 0

    &.page ~ .page
      top -1 * (input-group-height * number-inputs + ff-padding-top + ff-padding-bottom + header-height / 2)

    &.page:first-child
      z-index 1

    .thanks
      position absolute
      text-align center
      width 100%
      opacity 0
      transition all ease 1s 3s
      margin-left -30px
      // firefox, you are a bitch.
      transform rotateY(180deg)

  &:focus
    box-shadow 0 0 5px rgba(0,0,0,0.25)
    outline none

  .forcefield
    padding ff-padding

  .next-btn
    position absolute
    width 50px
    height:
      input-group-height * number-inputs + ff-padding-top + ff-padding-bottom

    right 0
    top (header-height / 2)px
    border-top-right-radius 4px
    border-bottom-right-radius 4px

    background white
    z-index -1

    transition right ease 0.2s,
               box-shadow ease 0.2s
    display table

    cursor pointer

    span
      display table-cell
      vertical-align middle
      transform-origin center center
      right 2px
      transform rotate(-90deg)

  &.persp
    form
      // NOTE(jordan): Must do all overarching translates
      // on form now, lest it overlap with next-btn
      position relative
      left -40px
    .primary-window
      transform rotateY(-3deg)
      box-shadow inset 0 30px rgba(0,0,0,0.015),
                 inset 0 25px rgba(0,0,0,0.02),
                 inset 0 10px rgba(0,0,0,0.025)

    .next-btn
      right -20px
      box-shadow inset 11px 0 rgba(0,0,0,0.04),
                 inset 12px 0 rgba(0,0,0,0.035),
                 inset 13px 0 rgba(0,0,0,0.03),
                 inset 14px 0 rgba(0,0,0,0.025),
                 inset 15px 0 rgba(0,0,0,0.02),
                 inset 16px 0 rgba(0,0,0,0.015)

      &:hover
        right -25px
        box-shadow inset 6px 0 rgba(0,0,0,0.04),
                   inset 7px 0 rgba(0,0,0,0.035),
                   inset 8px 0 rgba(0,0,0,0.03),
                   inset 9px 0 rgba(0,0,0,0.025),
                   inset 10px 0 rgba(0,0,0,0.02),
                   inset 11px 0 rgba(0,0,0,0.015)

  &.punched

    .primary-window
      transform-origin  50% 0%
      animation 3s punch-ticket

    .input-group
      opacity 0

    .thanks
      display block
      opacity 1
      top 95px

    .submit-btn
      opacity 0

    // because firefox is a bitch.
    &.end
      .primary-window
        max-height 620px
        // this one's for IE 10...
        transition none
        transform rotateY(180deg)

// FUKKKKKKiNG FIREFOX
// NOTE  the build kills the moz keyframes because it's a bitch about this shit.
// soooooo... ugh. copy this line every time it builds and you want to save.
@-moz-keyframes punch-ticket
  0%
    transform rotateX( 0deg ) translateY(0)
  35%
    transform rotateX(180deg) translateY(0)
  50%
    transform rotateX(180deg) translateY(80px)
    max-height 620px
  65%
    transform rotateX(180deg) translateY(0)
    max-height 620px
  100%
    transform rotateX(180deg) rotateZ(180deg)
    max-height 620px

@keyframes punch-ticket
   0%
    transform rotateX(0deg) translateY(0)
  35%
    transform rotateX(-180deg) translateY(0)
    height 620px
   50%
    transform rotateX(-180deg) translateY(80px)
    height 620px
  65%
    transform rotateX(-180deg) translateY(0)
    height 620px
  100%
    transform rotateX(-180deg) rotateZ(180deg)
    height 620px

@-webkit-keyframes punch-ticket
  0%
    transform rotateX(0deg) translateY(0)
  35%
    transform rotateX(-180deg) translateY(0)
    height 620px
  50%
    transform rotateX(-180deg) translateY(80px)
    height 620px
  65%
    transform rotateX(-180deg) translateY(0)
    height 620px
  100%
    transform rotateX(-180deg) rotateZ(180deg)
    height 620px

@-ms-keyframes punch-ticket
  0%
    transform rotateX(0deg) translateY(0)
  35%
    transform rotateX(180deg) translateY(0)
  50%
    transform rotateX(180deg) translateY(80px)
    height 620px
  65%
    transform rotateX(180deg) translateY(0)
    height 620px
  // for some reason, IE flips Z.
  100%
    transform rotateX(-180deg) rotateZ(180deg)
    height 620px
