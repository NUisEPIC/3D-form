@import '_vars'
@import '_base'
@import 'formula-inputs'

// formula

next-btn-height = input-group-height * number-inputs + ff-padding-top + ff-padding-bottom

.mobile-warning
  position absolute
  z-index 9999
  margin 20px 10%
  width 80%
  background #fafafa
  display none
  border-radius 4px
  box-shadow 0 0 10px 10px rgba(0,0,0,0.1)
  h2
    padding 0 30px

@media all and (max-width: 700px)
  .mobile-warning
    display block
    transition all ease 1s
    overflow: hidden
    max-height 100%
    &.dismissed
      max-height 0

form
  position relative
  transition all ease 0.5s
  left 0

.formula
  display block
  margin 0 auto
  width 85%
  position relative
  max-width 700px
  transition all ease 1s
  perspective 300px
  perspective-origin center center
  max-height 100%

  .header
    background-image url(../images/epic-logo.png)
    background-size contain
    background-repeat no-repeat
    width 300px
    height 300px
    display block
    margin 0 auto
    z-index 2
    position relative

  .primary-window
    border-radius 4px
    box-shadow 0 0 15px rgba(0,0,0,0.2)
    position relative

    max-height 100%
    background radial-gradient(circle, #f2f2f2 0%, #ebebeb 100%)
    transition all ease 0.5s

    transform-origin top center
    transform-style preserve-3d

    overflow hidden
    top -150px
    left 0

    &.page ~ .page
      top -1 * (input-group-height * number-inputs + ff-padding-top + ff-padding-bottom + header-height / 2)

    &.page:first-child
      z-index 1

    .thanks
      position absolute
      text-align center
      padding-top 20px
      width 100%
      opacity 0
      transition all ease 1s 3s
      // firefox, you are a bitch.
      transform rotateY(180deg)

      img
        position relative
        top 10px
        height 300px

  &:focus
    box-shadow 0 0 5px rgba(0,0,0,0.25)
    outline none

  .forcefield
    padding ff-padding

  .next-btn
    position absolute
    height next-btn-height - 4px

    top (header-height / 2)px + 2px
    right 0

    border-top-right-radius 4px
    border-bottom-right-radius 4px

    background white
    z-index -1

    transition all ease 0.5s
    display table
    transform rotateY(-4deg)

    cursor pointer

    .inner-btn
      display table-cell
      vertical-align middle

      span
        // NOTE(jordan): This width defines the width of all next-btn
        width 50px
        display block
        transform-origin center center
        right 2px
        transform rotate(-90deg)

  &.persp
    form
      // NOTE(jordan): Must do all overarching translates
      // on form now, lest it overlap with next-btn
      left -30px
    .primary-window
      transform rotateY(-3deg)
      box-shadow inset 0 30px rgba(0,0,0,0.015),
                 inset 0 25px rgba(0,0,0,0.02),
                 inset 0 10px rgba(0,0,0,0.025)

    .next-btn
      height next-btn-height + 26px
      top (header-height / 2)px - 13px
      right -34px
      transform rotateY(7deg)

      &:hover
        right -36px

  &.punched

    .primary-window
      animation 3s punch-ticket

    .next-btn
      display none

    .input-group
      opacity 0

    .thanks
      display block
      opacity 1
      top 95px

    .submit-btn
      opacity 0

    // because firefox is a bitch.
    &.end
      .primary-window
        // this one's for IE 10...
        transition none
        transform rotateY(180deg)

// FUKKKKKKiNG FIREFOX
// NOTE  the build kills the moz keyframes because it's a bitch about this shit.
// soooooo... ugh. copy this line every time it builds and you want to save.
@-moz-keyframes punch-ticket
  0%
    transform rotateX( 0deg ) translateY(0)
  35%
    transform rotateX(180deg) translateY(0)
  50%
    transform rotateX(180deg) translateY(80px)
  65%
    transform rotateX(180deg) translateY(0)
  100%
    transform rotateX(180deg) rotateZ(180deg)

@keyframes punch-ticket
  0%
    transform rotateX(0deg) translateY(0)
  35%
    transform rotateX(-180deg) translateY(0)
  50%
    transform rotateX(-180deg) translateY(80px)
  65%
    transform rotateX(-180deg) translateY(0)
  100%
    transform rotateX(-180deg) rotateZ(180deg)

@-ms-keyframes punch-ticket
  0%
    transform rotateX(0deg) translateY(0)
  35%
    transform rotateX(180deg) translateY(0)
  50%
    transform rotateX(180deg) translateY(80px)
    height 620px
  65%
    transform rotateX(180deg) translateY(0)
    height 620px
  // for some reason, IE flips Z.
  100%
    transform rotateX(-180deg) rotateZ(180deg)
    height 620px
