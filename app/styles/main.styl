@import '_vars'
@import '_base'
@import 'formula-inputs'

// formula
#formula-container
  width 100%
  height 100%
  perspective 300px
  perspective-origin center center

  overflow hidden

  *
    box-sizing border-box

section.sidebar
  width 250px
  height 100%
  position absolute
  z-index 9
  background white

  #formula-outline
    display inline-block
    width 100%
    height calc(100% - 250px - 1em)
    font-size 18px
    list-style-type none
    padding 0 1em 0 3em
    text-indent -1.5em
    overflow-y auto

  .header
    background-image url(../images/epic-logo.png)
    background-size 120%
    background-position 50% 50%
    background-repeat no-repeat
    width 250px
    height 250px
    position relative

.formula
  width calc(100% - 250px)
  position absolute
  left 250px
  transition all ease 1s
  height 100%

  form
    transition all ease 0.5s
    height 100%

    -moz-perspective 300px

  .primary-window
    position absolute

    overflow-y auto

    width 100%
    height 100%
    display inline-table
    background radial-gradient(circle, #f2f2f2 0%, #ebebeb 100%)
    transition transform ease 0.5s,
               left ease 0.5s

    transform-origin top center

    // FF hack
    -moz-perspective 300px

    overflow hidden
    left 0

    &.page
      opacity 0
      -webkit-transform translateZ(-1px)

    &.page.current
      z-index 1
      opacity 1
      -webkit-transform translateZ(0px)

    i.back-btn
      position absolute
      left 20px
      top 20px
      font-style normal
      color rgba(0,0,0,0.5)
      transition color ease 0.5s
      cursor pointer
      user-select none

      &:hover
        color rgb(0,0,0)

      &:before
        content '\2190'
        margin-right 10px
        position relative
        top -1px

    .thanks
      display none
      position absolute
      text-align center
      width 100%
      opacity 0
      top 115px
      transition all ease 1s
      // firefox, you are a bitch.
      transform rotateY(180deg)

      img
        position relative
        top 10px
        height 360px

  &:focus
    box-shadow 0 0 5px rgba(0,0,0,0.25)
    outline none

  .forcefield
    padding ff-padding
    box-sizing border-box
    display table-cell
    vertical-align middle
    max-width 820px

    h2
      text-align left

  .next-btn
    text-align center

    position absolute
    width 300px
    bottom 50px
    left calc(50% - 150px)
    padding 10px 0

    background white
    z-index 2

    -moz-perspective 300px

    cursor pointer

  &.shuffle
    .page
      left calc(-50% - 125px)
      -webkit-transform translateZ(-2px)

    .page.next
      opacity 1
      left calc(50% - 125px)
      transform rotateY(1deg)
      -webkit-transform translateZ(-1px) rotateY(1deg)

    &.reverse
      .page
        left calc(50% - 125px)
        -webkit-transform rotateY(-1deg) translateZ(-3px)

      .page.next
        opacity 1
        left calc(-50% - 125px)
        transform rotateY(-1deg)
        -webkit-transform translateZ(-1px) rotateY(1deg)

  &.punched
    .primary-window
      animation 3s punch-ticket
      & *
        opacity 0

    .thanks
      left 0
      display block
      transform rotateY(180deg)

      @media all and (max-height 800px)
        transform rotateY(180deg)

    // because firefox is a bitch.
    &.end
      .primary-window
        // this one's for IE 10...
        transition none
        transform rotateY(180deg)

      .thanks
        opacity 1
        transform rotateY(180deg)
        @media all and (max-height 800px)
          transform rotateY(180deg)
        & *
          opacity 1

.formula-notify-window
  position fixed
  top 20px
  right 20px
  display none
  opacity 0
  border-radius 4px
  padding 10px
  font-size 14px
  box-shadow 0 0 2px rgba(0,0,0,0.1)
  background #fafafa
  z-index 9999
  transition opacity ease 0.2s

  &:hover
    border 1px solid rgba(0,0,0,0.2)

// FUKKKKKKiNG FIREFOX
// NOTE  the build kills the moz keyframes because it's a bitch about this shit.
// soooooo... ugh. copy this line every time it builds and you want to save.
@-moz-keyframes punch-ticket
  0%
    transform rotateX( 0deg ) translateY(0)
  35%
    transform rotateX(180deg) translateY(0)
  50%
    transform rotateX(180deg) translateY(80px)
  65%
    transform rotateX(180deg) translateY(0)
  100%
    transform rotateX(180deg) rotateZ(180deg)

@keyframes punch-ticket
  0%
    transform rotateX(0deg) translateY(0)
    box-shadow initial
  35%
    transform rotateX(-180deg) translateY(0)
    box-shadow none
  50%
    transform rotateX(-180deg) translateY(80px)
  65%
    transform rotateX(-180deg) translateY(0)
  100%
    transform rotateX(-180deg) rotateZ(180deg)

@-ms-keyframes punch-ticket
  0%
    transform rotateX(0deg) translateY(0)
  35%
    transform rotateX(180deg) translateY(0)
  50%
    transform rotateX(180deg) translateY(80px)
  65%
    transform rotateX(180deg) translateY(0)
  // for some reason, IE flips Z.
  100%
    transform rotateX(-180deg) rotateZ(180deg)
